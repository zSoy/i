<!DOCTYPE html>
<html>
  <head>
    <title>临时测试</title>
    <script src=/i/common/c.min.js></script>
    <script src="https://sql.js.org/dist/sql-wasm.js"></script>
    <link rel="stylesheet" type="text/css" href="/i/common/c.css">
    <style type="text/css">
      #cntr{
        background:#222;
      }
      #box{
        display:flex;
        flex-flow:row wrap;
        flex:auto;
      }
      #left{
        width:220px;
        max-width:260px;
        height:100vh;
        display: flex;
        flex-flow:column;
        background:#333;
      }
      #logo{
        width:100%;
        min-height:74px;
        max-height:74px;
        border-bottom:1px solid rgba(129,129,129,.15);
      }
      #menu,#more{
        display:flex;
        flex-flow:column;
      }
      #menu{
        flex:auto;
        overflow-y:auto;
        overflow-x:hidden;
      }
      #more{
        border-top:1px solid rgba(129,129,129,.15);
        padding:.5rem 0;
      }
      .bitem{
        min-height:50px;
        max-height:50px;
        line-height:50px;
        padding-left:50px;
        color:#aaa;
        cursor:pointer;
        overflow:hidden;
        text-overflow:ellipsis;
        white-space:nowrap;
      }
      .bitem:hover{
        background:rgba(0,0,0,.2);
        color:#fff;
      }
      #right{
        height:100vh;
        display:flex;
        overflow:auto;
        flex-flow:column;
        flex:auto;
      }
      .header{
        position:fixed;
        width:100%;
        height:74px;
        background:#333;
        box-shadow:0 0 25px 5px rgb(10 10 10 / 25%);;
      }
      .middle{
        height:100%;
        margin:75px 0 25px 0;
        padding:110px 0 10px 0;
      }
      .search{
        max-width:800px;
        height:140px;
      }
      #artc{
        margin:30px;
      }
      p.sentence:hover{
        color:red;
      }
    </style>
  </head>
  <body>
    <div id="cntr">
      <div id="box">
        <div id="left">
          <div id="logo">
            <!---
            <a>
              <img loading="lazy" width="74px" src="">
            </a>
            -->
          </div>
          <div id="menu">
            <div class="bitem">网址导航</div>
            <div class="bitem">网址导航</div>
            <div class="bitem">网址导航</div>
            <div class="bitem">网址导航</div>
            <div class="bitem">网址导航</div>
          </div>
          <div id="more">
            <div class="bitem">博客</div>
            <div class="bitem">友链</div>
            <div class="bitem">免责声明</div>
          </div>
        </div>
        <div id="right">
          <div class="top">
            <div class="header">
              <div class="button">按钮</div>
            </div>
            <div class="middle">
              <div class="search">
                <div class="slist"></div>
                <div class="input_box"></div>
              </div>
            </div>
          </div>
          <div class="content"></div>
        </div>
      </div>
      <div id="tip"></div>
    </div>
    <script>
      //https://cdn.bootcss.com/github-markdown-css/3.0.1/github-markdown.css
      !async function(){
        const _ = document.querySelector.bind(document);
        const __ = document.querySelectorAll.bind(document);
        async function getDb(){
          let SQL = null, buf = null, db = null;
          while(!SQL||!buf||!db){
            try{
              SQL ??= await initSqlJs({locateFile: file => `https://sql.js.org/dist/${file}`});
              buf ??= await (await fetch("/i/sql.db")).arrayBuffer();
              db ??= new SQL.Database(new Uint8Array(buf));
              setTimeout(e=>1,3000);
            }catch(e){_('#tip').innerText="请求失败,正在重试";};
          }
          return db;
        }
        let db = await getDb();
        const content = s => s['artc_id']?`<div><p>${s.artc_title}</p><div>${s.artc_content}</div></div>`:`<div><p class="sentence" title="${s.sentence_meaning}">${s.sentence_content}</p></div>`;
        __('.bitem').on('click', e=>{
          const query = s => {
            let innerHTML = '';
            try{
              const stmt = db.prepare(s);
              while(stmt.step()){
                const row = stmt.getAsObject();
                innerHTML += content(row);
              }
            }catch(e) {console.log(e);}
            return innerHTML;
          }
          _('.content').innerHTML += query("select * from tb_blog_artc");
          _('.content').innerHTML += query("select * from tb_blog_sentence");
        });
        _(".button").on("click", e=>_('#left').style.removeProperty("width")==""?_('#left').style.setProperty("width","60px"):0);
      }();
    </script>
    <script defer src="/i/common/marked.min.js"></script>
  </body>
</html>
